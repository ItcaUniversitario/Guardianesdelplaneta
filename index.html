<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Defensores del Jard√≠n</title>
    <style>
        /* Estilos generales y de layout */
        :root {
            --color-cielo: #87CEEB;
            --color-pasto: #8BC34A;
            --color-tierra: #A1887F;
            --color-panel: #2c3e50;
            --color-texto: #ecf0f1;
            --color-sombra: rgba(0, 0, 0, 0.2);
            --fuente-principal: 'Arial', sans-serif;
            
            /* Definimos el tama√±o base del juego (210px men√∫ + 800px juego) */
            --game-width: 1010px; 
            --game-height: 600px;
        }

        body {
            font-family: var(--fuente-principal);
            margin: 0;
            background-color: var(--color-cielo);
            color: var(--color-texto);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            height: 100vh; 
            overflow: hidden; /* Oculta barras de desplazamiento del cuerpo */
            transition: background-color 0.5s ease;
        }

        /* üéØ Contenedor para el escalado (mantiene la proporci√≥n) */
        .game-wrapper {
            position: relative;
            /* El tama√±o del wrapper es el tama√±o base del juego */
            width: var(--game-width);
            height: var(--game-height);
            
            /* üìê L√ìGICA DE ESCALADO RESPONSIVE: Escala para que quepa en la ventana */
            transform-origin: center center;
            transform: scale(
                min(
                    1, 
                    calc(100vh / var(--game-height)), 
                    calc(100vw / var(--game-width))
                )
            );
            box-shadow: 0 10px 20px var(--color-sombra);
            border-radius: 15px;
        }

        .game-container {
            position: relative;
            /* El contenedor interno mantiene el tama√±o base */
            width: var(--game-width);
            height: var(--game-height);
            background-color: var(--color-pasto);
            border-radius: 15px;
            overflow: hidden;
            border: 5px solid #386641;
            display: flex;
            flex-direction: column;
        }

        /* HUD - Interfaz de Usuario */
        .hud {
            width: 100%;
            height: 50px;
            background-color: rgba(44, 62, 80, 0.8);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            font-size: 18px;
            font-weight: bold;
            border-bottom: 3px solid #6a994e;
        }

        .hud-item {
            display: flex;
            align-items: center;
            margin: 0 10px;
        }

        .hud-item span {
            margin-left: 8px;
        }
        
        /* Estilos para el logo en el HUD */
        .game-logo {
            flex-grow: 1;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .game-logo img {
            max-height: 40px;
            max-width: 150px;
            object-fit: contain;
            margin-right: 30px;
        }

        /* Barra de progreso de oleada */
        .wave-progress-container {
            flex-grow: 1;
            height: 20px;
            background-color: #555;
            border-radius: 10px;
            margin: 0 20px;
            overflow: hidden;
            border: 2px solid #333;
        }

        .wave-progress-bar {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, #ffd700, #ff8c00);
            border-radius: 8px 0 0 8px;
            transition: width 0.5s ease-in-out;
        }
        
        /* Contenedor del √°rea de juego para posicionar los elementos */
        .game-area-container {
            position: relative;
            flex-grow: 1;
            display: flex;
        }
        
        /* Ajustamos el tama√±o y posici√≥n del canvas */
        canvas {
            display: block;
            width: 800px;
            height: 100%;
        }
        
        /* Barra lateral de defensores */
        .defenders-menu {
            position: relative;
            left: 0;
            top: 0;
            bottom: 0;
            width: 210px;
            background-color: rgba(96, 125, 139, 0.8);
            padding-top: 10px;
            display: flex;
            flex-wrap: wrap; 
            justify-content: center;
            align-content: flex-start;
            border-right: 3px solid #a7c957;
            overflow-y: hidden;
        }

        .defender-card {
            width: 80px;
            height: 90px;
            background-color: #f2e8cf;
            border: 2px solid #a7c957;
            border-radius: 10px;
            margin: 5px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: transform 0.2s, box-shadow 0.2s;
            color: #333;
        }
        
        .defender-card.selected {
            transform: scale(1.1);
            box-shadow: 0 0 15px #f4a261;
            border-color: #f4a261;
        }

        .defender-card:hover {
            transform: scale(1.05);
        }

        .defender-icon {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .defender-icon img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .defender-cost {
            font-size: 14px;
            font-weight: bold;
            margin-top: 5px;
        }
        
        .defender-cost span {
            color: #2a9d8f;
        }

        /* ---------------------------------------------------- */
        /* ESTILOS DE MODALES */
        /* ---------------------------------------------------- */
        .modal-overlay {
            position: absolute; 
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        /* Estilos generales del contenido del modal */
        .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            color: #333;
            /* Estos estilos se aplicar√°n a los modales educativos */
            width: 800px; 
            max-width: 90%; 
            height: 500px;
        }
        
        /* ESTILO ESPEC√çFICO PARA EL MODAL DE BIENVENIDA (M√°s peque√±o) */
        .modal-content.start-modal-size {
            width: 550px; 
            max-width: 90%;
            height: auto; /* Altura ajustada al contenido */
            max-height: 550px; /* Menor que 600px */
        }
        
        /* Habilitar el scroll dentro del cuerpo del modal */
        .modal-body {
            flex-grow: 1;
            position: relative;
            line-height: 1.6;
            overflow-y: auto; 
        }

        /* Iconos en la lista de instrucciones */
        .modal-body .defender-icon-list {
            width: 24px;
            height: 24px;
            display: inline-block;
            vertical-align: middle; /* Alineaci√≥n con el texto */
            margin-right: 5px;
        }
        .modal-body .defender-icon-list img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        /* ---------------------------------------------------- */


        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
        }

        .modal-close-btn {
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            border: none;
            background: none;
        }

        .modal-body ul {
            list-style: none;
            padding: 0;
        }
        .modal-body li {
            margin-bottom: 10px;
            font-size: 16px;
        }
        .modal-body strong {
            color: #386641;
        }

        .modal-body iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .iframe-fallback {
            display: none;
            text-align: center;
            padding: 50px;
        }

        .fallback-button {
            padding: 12px 25px;
            font-size: 20px;
            cursor: pointer;
            background-color: var(--color-pasto);
            color: white;
            border: none;
            border-radius: 8px;
            transition: background-color 0.2s;
            margin-top: 20px;
        }
        .fallback-button:hover {
            background-color: #6a994e;
        }

        /* Mensajes en pantalla (pausa, game over) */
        .game-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.75);
            color: white;
            padding: 30px 50px;
            border-radius: 20px;
            font-size: 48px;
            font-weight: bold;
            text-align: center;
            display: none;
        }
    </style>
</head>
<body>

    <div class="game-wrapper">
        <div class="game-container">
            <div class="hud">
                <div class="hud-item" title="Energ√≠a Verde">
                    <span>üçÉ</span>
                    <span id="energiaVerde">100</span>
                </div>
                <div class="hud-item" title="Puntos Ambientales">
                    <span>üåç</span>
                    <span id="puntosAmbientales">0</span>
                </div>
                
                <div class="game-logo" id="gameLogo">
                    <img src="https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/itcaverdeblanco.png" alt="">
                    <span>Guardianes del Planeta</span>
                </div>
            
                <div class="hud-item" title="Oleada Actual">
                    <span>üåä</span>
                    <span id="oleadaActual">1 / 5</span>
                </div>
                <div class="wave-progress-container">
                    <div id="waveProgressBar" class="wave-progress-bar"></div>
                </div>
                 <div class="hud-item" title="Controles: M (Silencio), P (Pausa)">
                    <span id="audioStatus">üîä</span>
                    <span id="pauseStatus">‚ñ∂Ô∏è</span>
                </div>
            </div>

            <div class="game-area-container">
                <div class="defenders-menu" id="defendersMenu">
                    </div>
                <canvas id="gameCanvas"></canvas>
            </div>
            
            <div id="pauseMessage" class="game-message">JUEGO EN PAUSA</div>
            <div id="gameOverMessage" class="game-message">
                <span id="gameOverText">FIN DEL JUEGO</span>
                <button id="restartBtn" class="fallback-button">Reiniciar</button>
            </div>
        </div>
    

        <div id="startModal" class="modal-overlay">
            <div class="modal-content start-modal-size">
                <div class="modal-header">
                    <h2 class="modal-title">¬°Bienvenido a Guardianes del Planeta!</h2>
                </div>
                <div class="modal-body" style="text-align: left;">
                    <h3>Tu Misi√≥n:</h3>
                    <p>Protege el jard√≠n ITCA de las amenazas de la contaminaci√≥n. Coloca defensores para detener a los enemigos que avanzan desde la derecha.</p>
                    <h3>Defensores Sostenibles:</h3>
                    <ul>
                        <li><div class="defender-icon-list"><img src="https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/arbol.png" alt="√Årbol Icono"></div> <strong>:</strong> Frena enemigos y dispara ‚Äúhojas verdes‚Äù.</li>
                        <li><div class="defender-icon-list"><img src="https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/panel_solar.png" alt="Panel Solar Icono"></div> <strong>:</strong> No ataca, pero genera m√°s energ√≠a verde.</li>
                        <li><div class="defender-icon-list"><img src="https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/bicicleta.png" alt="Bicicleta Icono"></div> <strong>:</strong> Dispara r√°pido y debilita el humo.</li>
                        <li><div class="defender-icon-list"><img src="https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/contenedor_plastico.png" alt="Contenedor Pl√°stico Icono"></div> <strong>:</strong> Recicla enemigos de pl√°stico.</li>
                        <li><div class="defender-icon-list"><img src="https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/contenedor_organico.png" alt="Contenedor Org√°nico Icono"></div> <strong>:</strong> Recicla enemigos de basura org√°nica.</li>
                        <li><div class="defender-icon-list"><img src="https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/contenedor_comun.png" alt="Contenedor Comunes Icono"></div> <strong>:</strong> Recolecta enemigos de desechos comunes.</li>
                        <li><div class="defender-icon-list"><img src="https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/contenedor_vidrio_metal.png" alt="Contenedor Vidrio/Metal Icono"></div> <strong>:</strong> Neutraliza enemigos de vidrio y metal.</li>
                        <li><div class="defender-icon-list"><img src="https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/contenedor_papel.png" alt="Contenedor Papel Icono"></div> <strong>:</strong> Recicla enemigos de papel y cart√≥n.</li>
                        <li><div class="defender-icon-list"><img src="https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/contenedor_especiales.png" alt="Contenedor Especiales Icono"></div> <strong>:</strong> Neutraliza enemigos especiales como neum√°ticos.</li>
                        <li><div class="defender-icon-list"><img src="https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/contenedor_peligrosos.png" alt="Contenedor Peligrosos Icono"></div> <strong>:</strong> Neutraliza enemigos peligrosos como residuos de hospital.</li>
                    </ul>
                    <button id="startGameBtn" class="fallback-button" style="width: 100%;">¬°A Jugar!</button>
                </div>
            </div>
        </div>

        <div id="educationalModal" class="modal-overlay">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modalTitle" class="modal-title">Recurso Educativo</h2>
                    <button id="modalCloseBtn" class="modal-close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <iframe id="resourceIframe" sandbox="allow-scripts allow-same-origin allow-popups"></iframe>
                    <div id="iframeFallback" class="iframe-fallback">
                        <p>Este contenido no se puede mostrar aqu√≠.</p>
                        <button id="fallbackBtn" class="fallback-button">Abrir en nueva pesta√±a</button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script>
        // ===================================================================================
        // ============================ PERSONALIZA AQU√ç =====================================
        // ===================================================================================

        // üñºÔ∏è RECURSOS GR√ÅFICOS
        const RECURSOS_GRAFICOS = {
            'arbol': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/arbol.png',
            'panel': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/panel_solar.png',
            'bicicleta': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/bicicleta.png',
            'contenedor_plastico': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/contenedor_plastico.png',
            'contenedor_organico': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/contenedor_organico.png',
            'contenedor_comun': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/contenedor_comun.png',
            'contenedor_vidrio_metal': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/contenedor_vidrio_metal.png',
            'contenedor_papel': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/contenedor_papel.png',
            'contenedor_especiales': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/contenedor_especiales.png',
            'contenedor_peligrosos': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/contenedor_peligrosos.png',
            'plastico': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/plastico.png',
            'humo': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/humo.png',
            'agua': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/agua.png',
            'basura_organica': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/basura_organica.png',
            'desecho_comun': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/desecho_comun.png',
            'vidrio_metal': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/vidrio_metal.png',
            'papel_carton': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/papel_carton.png',
            'residuos_especiales': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/residuos_especiales.png',
            'residuos_peligrosos': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/residuos_peligrosos.png',
            'fabrica': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/fabrica.png',
            'monstruo_basura': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/monstruo_basura.png',
            'proyectil_hoja': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/hoja_verde.png',
            'proyectil_engranaje': 'https://raw.githubusercontent.com/lennin1219/JuegoPlantsVSzombies/main/engranaje.png'
        };
        
        let imagenes = {};

        const ENEMIGOS = [
            { id: "plastico", vida: 6, velocidad: 0.25, puntos: 10, imagen: 'plastico', ancho: 60, alto: 50, afecta: "contenedor_plastico" },
            { id: "humo", vida: 3, velocidad: 0.5, puntos: 15, imagen: 'humo', ancho: 70, alto: 70 },
            { id: "agua", vida: 4, velocidad: 0.35, puntos: 20, imagen: 'agua', ancho: 70, alto: 70 },
            { id: "basura_organica", vida: 8, velocidad: 0.3, puntos: 25, imagen: 'basura_organica', ancho: 70, alto: 60, afecta: "contenedor_organico" },
            { id: "desecho_comun", vida: 10, velocidad: 0.2, puntos: 30, imagen: 'desecho_comun', ancho: 90, alto: 80, afecta: "contenedor_comun" },
            { id: "vidrio_metal", vida: 15, velocidad: 0.2, puntos: 40, imagen: 'vidrio_metal', ancho: 90, alto: 80, afecta: "contenedor_vidrio_metal" },
            { id: "papel_carton", vida: 7, velocidad: 0.4, puntos: 35, imagen: 'papel_carton', ancho: 90, alto: 70, afecta: "contenedor_papel" },
            { id: "residuos_especiales", vida: 20, velocidad: 0.15, puntos: 50, imagen: 'residuos_especiales', ancho: 90, alto: 70, afecta: "contenedor_especiales" },
            { id: "residuos_peligrosos", vida: 25, velocidad: 0.1, puntos: 75, imagen: 'residuos_peligrosos', ancho: 90, alto: 90, afecta: "contenedor_peligrosos" },
            { id: "fabrica", vida: 30, velocidad: 0.1, puntos: 100, esJefe: true, imagen: 'fabrica', ancho: 100, alto: 100 },
            { id: "monstruo_basura", vida: 50, velocidad: 0.08, puntos: 250, esJefe: true, imagen: 'monstruo_basura', ancho: 120, alto: 90 }
        ];

        const DEFENSORES = [
            { id: "arbol", nombre: "√Årbol", costo: 50, vida: 10, ataque: 1, cadencia: 1500, rango: 250, imagen: 'arbol', ancho: 70, alto: 70, oleada: 1, afecta_a: ["plastico", "humo", "agua", "basura_organica", "desecho_comun", "vidrio_metal", "papel_carton", "residuos_especiales", "residuos_peligrosos", "fabrica", "monstruo_basura"] },
            { id: "panel", nombre: "Panel Solar", costo: 25, vida: 5, energiaExtra: 15, cadencia: 5000, imagen: 'panel', ancho: 50, alto: 50, oleada: 1 },
            { id: "bicicleta", nombre: "Bicicleta", costo: 75, vida: 7, ataque: 0.5, cadencia: 500, rango: 300, imagen: 'bicicleta', ancho: 60, alto: 40, oleada: 1, afecta_a: ["humo", "agua", "fabrica", "monstruo_basura"] },
            { id: "contenedor_plastico", nombre: "Pl√°stico", costo: 50, vida: 20, efecto: "neutraliza", target: "plastico", imagen: 'contenedor_plastico', ancho: 50, alto: 50, oleada: 1 },
            { id: "contenedor_organico", nombre: "Org√°nico", costo: 120, vida: 20, efecto: "neutraliza", target: "basura_organica", imagen: 'contenedor_organico', ancho: 50, alto: 50, oleada: 2 },
            { id: "contenedor_comun", nombre: "Comunes", costo: 150, vida: 25, efecto: "neutraliza", target: "desecho_comun", imagen: 'contenedor_comun', ancho: 50, alto: 50, oleada: 3 },
            { id: "contenedor_vidrio_metal", nombre: "Vidrio/Metal", costo: 175, vida: 30, efecto: "neutraliza", target: "vidrio_metal", imagen: 'contenedor_vidrio_metal', ancho: 50, alto: 50, oleada: 4 },
            { id: "contenedor_papel", nombre: "Papel", costo: 175, vida: 20, efecto: "neutraliza", target: "papel_carton", imagen: 'contenedor_papel', ancho: 50, alto: 50, oleada: 4 },
            { id: "contenedor_especiales", nombre: "Especiales", costo: 250, vida: 40, efecto: "neutraliza", target: "residuos_especiales", imagen: 'contenedor_especiales', ancho: 50, alto: 50, oleada: 5 },
            { id: "contenedor_peligrosos", nombre: "Peligrosos", costo: 300, vida: 40, efecto: "neutraliza", target: "residuos_peligrosos", imagen: 'contenedor_peligrosos', ancho: 50, alto: 50, oleada: 5 }
        ];

        const RECURSOS_EDUCATIVOS = [
            {
                id: "reciclaje",
                titulo: "Aprende a Reciclar Correctamente",
                url: "https://youtu.be/6JZ8QcDJHZI"
            },
            {
                id: "energia",
                titulo: "El Futuro es Renovable",
                url: "https://www.holaconsumoresponsable.com/"
            },
            {
                id: "agua",
                titulo: "La Importancia de Cuidar el Agua",
                url: "https://www.youtube.com/shorts/wNsQAhJhSXE"
            },
            {
                id: "economia_circular",
                titulo: "¬øQu√© es la Econom√≠a Circular?",
                url: "https://www.youtube.com/embed/3HnZ4NjVsjU"
            },
            {
                id: "isla_plastico",
                titulo: "La Gran Mancha de Basura del Pac√≠fico",
                url: "https://www.youtube.com/embed/Xd4xAph5WFM"
            }
        ];
        
        const OLEADAS = [
            { enemigos: ["plastico", "plastico", "plastico", "humo", "plastico", "humo", "agua", "agua"] },
            { enemigos: ["plastico", "humo", "agua", "basura_organica", "plastico", "humo", "agua", "basura_organica", "basura_organica"] },
            { enemigos: ["agua", "desecho_comun", "humo", "plastico", "desecho_comun", "plastico", "agua", "desecho_comun", "humo", "desecho_comun"] },
            { enemigos: ["plastico", "humo", "vidrio_metal", "agua", "papel_carton", "agua", "plastico", "humo", "vidrio_metal", "papel_carton", "fabrica"] },
            { enemigos: ["agua", "humo", "fabrica", "residuos_especiales", "desecho_comun", "vidrio_metal", "residuos_peligrosos", "plastico", "monstruo_basura"] }
        ];

        const ENTORNOS = [
            { tierra: '#a98467', pasto: '#6a994e', cielo: '#87CEEB', detalles: null },
            { tierra: '#b0b0b0', pasto: '#76b852', cielo: '#a7d7f9', detalles: (ctx) => {
                ctx.fillStyle = '#888'; ctx.fillRect(0, 290, 800, 20);
            }},
            { tierra: '#f4e1c1', pasto: '#0077be', cielo: '#87CEEB', detalles: (ctx) => {
                ctx.fillStyle = '#6ab5d8'; ctx.fillRect(0, 0, 800, 50);
                ctx.fillStyle = 'rgba(255,255,255,0.2)'; ctx.fillRect(0, 50, 800, 10);
            }},
            { tierra: '#6b4f2e', pasto: '#2e4c3b', cielo: '#b0c4de', detalles: (ctx) => {
                ctx.strokeStyle = '#251a0e'; ctx.lineWidth = 3; 
                ctx.beginPath();
                ctx.moveTo(0, 100); ctx.lineTo(800, 120);
                ctx.moveTo(0, 300); ctx.lineTo(800, 280);
                ctx.moveTo(0, 500); ctx.lineTo(800, 510);
                ctx.stroke();
            }},
            { tierra: '#5d5550', pasto: '#444', cielo: '#888', detalles: (ctx) => {
                ctx.fillStyle = 'rgba(0,0,0,0.15)';
                ctx.beginPath();
                ctx.arc(250, 550, 80, 0, Math.PI * 2);
                ctx.arc(650, 560, 100, 0, Math.PI * 2);
                ctx.arc(800, 100, 120, 0, Math.PI * 2);
                ctx.fill();
            }}
        ];

        const OPCIONES = {
            energiaInicial: 100,
            puntosBonus: 100,
            puntosPenalizacion: -50,
            tiempoMinActividad: 10,
            energiaAutomatica: 5,
            intervaloEnergia: 2500
        };

        // ===================================================================================
        // ========================== FIN DE LA PERSONALIZACI√ìN ==============================
        // ===================================================================================

        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const energiaVerdeEl = document.getElementById('energiaVerde');
        const puntosAmbientalesEl = document.getElementById('puntosAmbientales');
        const oleadaActualEl = document.getElementById('oleadaActual');
        const defendersMenuEl = document.getElementById('defendersMenu');
        const modalEl = document.getElementById('educationalModal');
        const modalCloseBtn = document.getElementById('modalCloseBtn');
        const modalTitleEl = document.getElementById('modalTitle');
        const resourceIframeEl = document.getElementById('resourceIframe');
        const iframeFallbackEl = document.getElementById('iframeFallback');
        const fallbackBtn = document.getElementById('fallbackBtn');
        const pauseMessageEl = document.getElementById('pauseMessage');
        const gameOverMessageEl = document.getElementById('gameOverMessage');
        const gameOverTextEl = document.getElementById('gameOverText');
        const restartBtn = document.getElementById('restartBtn');
        const audioStatusEl = document.getElementById('audioStatus');
        const pauseStatusEl = document.getElementById('pauseStatus');
        const startModalEl = document.getElementById('startModal');
        const startGameBtn = document.getElementById('startGameBtn');
        const waveProgressBar = document.getElementById('waveProgressBar');

        let gameState = {};
        //let imagenes = {};

        function loadImages() {
            let loadedCount = 0;
            const totalImages = Object.keys(RECURSOS_GRAFICOS).length;

            return new Promise((resolve, reject) => {
                for (const key in RECURSOS_GRAFICOS) {
                    const img = new Image();
                    img.onload = () => {
                        imagenes[key] = img;
                        loadedCount++;
                        if (loadedCount === totalImages) {
                            resolve();
                        }
                    };
                    img.onerror = () => {
                        console.error(`Error al cargar la imagen: ${RECURSOS_GRAFICOS[key]}`);
                        loadedCount++;
                        if (loadedCount === totalImages) {
                            resolve();
                        }
                    };
                    img.src = RECURSOS_GRAFICOS[key];
                }
            });
        }

        let audioCtx;
        let autoEnergyInterval;
        function initAudio() {
            try {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            } catch (e) {
                console.warn('Web Audio API no es soportada en este navegador.');
            }
        }

        function playSound(type) {
            if (!audioCtx || gameState.muted) return;
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            switch (type) {
                case 'recolectar':
                    oscillator.type = 'triangle';
                    oscillator.frequency.setValueAtTime(880, audioCtx.currentTime);
                    gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.5);
                    break;
                case 'colocar':
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(440, audioCtx.currentTime);
                    gainNode.gain.setValueAtTime(0.4, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.2);
                    break;
                case 'derrotar':
                    oscillator.type = 'square';
                    oscillator.frequency.setValueAtTime(200, audioCtx.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.2);
                    gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.2);
                    break;
                case 'error':
                    oscillator.type = 'sawtooth';
                    oscillator.frequency.setValueAtTime(120, audioCtx.currentTime);
                    gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.3);
                    break;
            }
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.5);
        }
        
        // --- INICIALIZACI√ìN DEL JUEGO ---
        function initGame() {
            canvas.width = 800;
            canvas.height = 600;

            if (autoEnergyInterval) clearInterval(autoEnergyInterval);

            gameState = {
                energia: OPCIONES.energiaInicial,
                puntos: 0,
                oleadaActual: 0,
                grid: createGrid(5, 8),
                defensores: [],
                enemigos: [],
                proyectiles: [],
                particulas: [],
                gameOver: false,
                paused: false,
                muted: false,
                selectedDefender: null,
                modalTimer: null,
                modalStartTime: 0,
                lastFrameTime: 0,
                totalEnemigosOleada: 0,
                enemigosDerrotadosOleada: 0,
            };
            
            populateDefendersMenu();
            updateHUD();
            startOleada();
            
            autoEnergyInterval = setInterval(() => {
                if (!gameState.paused && !gameState.gameOver) {
                    gameState.energia += OPCIONES.energiaAutomatica;
                    createParticle(50, 25, 'üçÉ', '#2a9d8f');
                    playSound('recolectar');
                    updateHUD();
                }
            }, OPCIONES.intervaloEnergia);

            gameLoop(0);
        }
        
        function createGrid(rows, cols) {
            const grid = [];
            for (let y = 0; y < rows; y++) {
                grid[y] = [];
                for (let x = 0; x < cols; x++) {
                    grid[y][x] = null;
                }
            }
            return grid;
        }

        function populateDefendersMenu() {
            defendersMenuEl.innerHTML = '';
            const defensoresDisponibles = DEFENSORES.filter(d => d.oleada <= (gameState.oleadaActual + 1));
            defensoresDisponibles.forEach(def => {
                const card = document.createElement('div');
                card.className = 'defender-card';
                card.dataset.id = def.id;
                
                const iconHtml = `<div class="defender-icon"><img src="${RECURSOS_GRAFICOS[def.imagen]}" alt="${def.nombre}"></div>`;

                card.innerHTML = `
                    ${iconHtml}
                    <div>${def.nombre}</div>
                    <div class="defender-cost"><span>üçÉ</span> ${def.costo}</div>
                `;
                card.addEventListener('click', () => selectDefender(def.id, card));
                defendersMenuEl.appendChild(card);
            });
        }

        // --- L√ìGICA DE OLEADAS Y ENEMIGOS ---
        function startOleada() {
            if (gameState.oleadaActual >= OLEADAS.length) {
                endGame(true);
                return;
            }
            
            const oleada = OLEADAS[gameState.oleadaActual];
            gameState.totalEnemigosOleada = oleada.enemigos.length;
            gameState.enemigosDerrotadosOleada = 0;
            updateWaveProgress();
            populateDefendersMenu();
            
            let spawnDelay = 1000;
            oleada.enemigos.forEach(tipoEnemigo => {
                setTimeout(() => {
                    if (!gameState.gameOver) spawnEnemy(tipoEnemigo);
                }, spawnDelay);
                spawnDelay += Math.random() * 2000 + 2000;
            });
            updateHUD();
        }

        function spawnEnemy(tipo) {
            const enemigoData = ENEMIGOS.find(e => e.id === tipo);
            if (!enemigoData) return;
            const fila = Math.floor(Math.random() * 5);
            const y = fila * 100 + 50;
            
            gameState.enemigos.push({
                ...enemigoData,
                x: canvas.width + 50,
                y: y,
                fila: fila,
                maxVida: enemigoData.vida,
                idUnico: Math.random()
            });
        }

        function endOleada() {
            gameState.oleadaActual++;
            if (gameState.oleadaActual < OLEADAS.length) {
                const resource = RECURSOS_EDUCATIVOS[gameState.oleadaActual - 1];
                openRecurso(resource);
            } else {
                endGame(true);
            }
        }
        
        // --- L√ìGICA DE DEFENSORES ---
        function selectDefender(id, card) {
            const defenderData = DEFENSORES.find(d => d.id === id);
            if (gameState.energia >= defenderData.costo) {
                gameState.selectedDefender = id;
                document.querySelectorAll('.defender-card').forEach(c => c.classList.remove('selected'));
                card.classList.add('selected');
            } else {
                playSound('error');
                createParticle(card.getBoundingClientRect().x, card.getBoundingClientRect().y, 'No üçÉ', 'red');
            }
        }

        function placeDefender(gridX, gridY) {
            if (!gameState.selectedDefender || gameState.grid[gridY][gridX]) return;
            
            const defenderData = DEFENSORES.find(d => d.id === gameState.selectedDefender);
            if (gameState.energia >= defenderData.costo) {
                gameState.energia -= defenderData.costo;
                const newDefender = {
                    ...defenderData,
                    x: gridX * 100 + 50,
                    y: gridY * 100 + 50,
                    gridX,
                    gridY,
                    maxVida: defenderData.vida,
                    lastActionTime: Date.now()
                };
                gameState.defensores.push(newDefender);
                gameState.grid[gridY][gridX] = newDefender;
                gameState.selectedDefender = null;
                document.querySelectorAll('.defender-card').forEach(c => c.classList.remove('selected'));
                playSound('colocar');
                updateHUD();
            }
        }

        // --- BUCLE PRINCIPAL DEL JUEGO ---
        function gameLoop(timestamp) {
            if (gameState.gameOver) {
                return;
            }

            if (!gameState.lastFrameTime) gameState.lastFrameTime = timestamp;
            const dt = (timestamp - gameState.lastFrameTime) / 1000;
            gameState.lastFrameTime = timestamp;

            if (!gameState.paused) {
                updateGame(dt);
            }
            renderGame();
            
            requestAnimationFrame(gameLoop);
        }

        function updateGame(dt) {
            // Actualizar defensores
            gameState.defensores.forEach(def => {
                if (Date.now() - def.lastActionTime > def.cadencia) {
                    def.lastActionTime = Date.now();
                    if (def.id === 'panel') {
                        gameState.energia += def.energiaExtra;
                        playSound('recolectar');
                        createParticle(def.x, def.y - 20, `+${def.energiaExtra}üçÉ`, '#f9c74f');
                        updateHUD();
                    }
                    if (def.afecta_a) {
                        const enemigoEnFila = gameState.enemigos.find(e => 
                            e.fila === def.gridY && e.x > def.x && e.x < def.x + def.rango && def.afecta_a.includes(e.id)
                        );
                        if (enemigoEnFila) {
                            gameState.proyectiles.push({
                                x: def.x + 20, y: def.y, damage: def.ataque,
                                speed: def.id === 'bicicleta' ? 300 : 150,
                                imagen: def.id === 'bicicleta' ? 'proyectil_engranaje' : 'proyectil_hoja',
                                fila: def.gridY,
                                afecta_a: def.afecta_a
                            });
                        }
                    }
                }
            });

            // Actualizar proyectiles
            gameState.proyectiles = gameState.proyectiles.filter(p => p.x <= canvas.width);
            gameState.proyectiles.forEach(p => p.x += p.speed * dt);

            // Actualizar enemigos
            gameState.enemigos.forEach(enemigo => {
                enemigo.x -= enemigo.velocidad * 60 * dt;
                if (enemigo.x < 0) {
                    endGame(false);
                }
            });

            // Colisiones
            handleCollisions();
            
            // Actualizar part√≠culas
            gameState.particulas = gameState.particulas.filter(p => p.alpha > 0);
            gameState.particulas.forEach(p => {
                p.y -= 30 * dt;
                p.alpha -= 1.5 * dt;
            });
            
            // Comprobar fin de oleada
            if (gameState.enemigos.length === 0 && gameState.enemigosDerrotadosOleada === gameState.totalEnemigosOleada) {
                if (!gameState.esperandoOleada) {
                    gameState.esperandoOleada = true;
                    setTimeout(() => {
                        if (gameState.enemigos.length === 0 && !gameState.gameOver) {
                            endOleada();
                            gameState.esperandoOleada = false;
                        }
                    }, 3000); 
                }
            }
        }
        
        function handleCollisions() {
            for (let i = gameState.proyectiles.length - 1; i >= 0; i--) {
                const p = gameState.proyectiles[i];
                for (let j = gameState.enemigos.length - 1; j >= 0; j--) {
                    const e = gameState.enemigos[j];
                    if (p.fila === e.fila && Math.abs(p.x - e.x) < 20 && (p.afecta_a ? p.afecta_a.includes(e.id) : true)) {
                        e.vida -= p.damage;
                        gameState.proyectiles.splice(i, 1);
                        if (e.vida <= 0) {
                            gameState.puntos += e.puntos;
                            gameState.enemigosDerrotadosOleada++;
                            updateWaveProgress();
                            playSound('derrotar');
                            createParticle(e.x, e.y, `+${e.puntos}üåç`, '#80ed99');
                            gameState.enemigos.splice(j, 1);
                        }
                        break;
                    }
                }
            }

            gameState.enemigos.forEach(e => {
                const gridX = Math.floor(e.x / 100);
                if (gridX < 0 || gridX > 7) return;
                const def = gameState.grid[e.fila][gridX];
                if (def && Math.abs(e.x - (def.gridX * 100 + 50)) < 30) {
                    if (def.efecto === "neutraliza" && def.target === e.id) {
                        gameState.puntos += e.puntos * 2;
                        gameState.enemigosDerrotadosOleada++; 
                        updateWaveProgress();
                        createParticle(e.x, e.y, `+${e.puntos*2}üåç`, '#40916c');
                        gameState.enemigos = gameState.enemigos.filter(en => en.idUnico !== e.idUnico);
                        def.vida -= 1;
                    } else {
                        def.vida -= 0.05; 
                    }
                    
                    if (def.vida <= 0) {
                        gameState.grid[def.gridY][def.gridX] = null;
                        gameState.defensores = gameState.defensores.filter(d => !(d.gridX === def.gridX && d.gridY === def.gridY));
                    }
                }
            });
        }
        
        function hayEnemigoEnFila(fila, x, rango) {
            return gameState.enemigos.some(e => e.fila === fila && e.x > x && e.x < x + rango);
        }

        function drawBackground() {
            const entorno = ENTORNOS[Math.min(gameState.oleadaActual, ENTORNOS.length - 1)];
            document.body.style.backgroundColor = entorno.cielo;
            
            ctx.fillStyle = entorno.tierra;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            if (entorno.detalles) {
                entorno.detalles(ctx);
            }
        }

        function renderGame() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawBackground();

            for (let y = 0; y < 5; y++) {
                for (let x = 0; x < 8; x++) {
                    ctx.strokeStyle = 'rgba(255, 255, 255, 0.15)';
                    ctx.strokeRect(x * 100, y * 100, 100, 100);
                }
            }

            gameState.defensores.forEach(def => {
                const img = imagenes[def.imagen];
                if (img) {
                    ctx.drawImage(img, def.x - def.ancho / 2, def.y - def.alto / 2, def.ancho, def.alto);
                }
                
                if (def.vida < def.maxVida) {
                    ctx.fillStyle = 'red';
                    ctx.fillRect(def.x - 20, def.y + 25, 40, 5);
                    ctx.fillStyle = 'green';
                    ctx.fillRect(def.x - 20, def.y + 25, 40 * (def.vida / def.maxVida), 5);
                }
            });

            gameState.enemigos.forEach(e => {
                const img = imagenes[e.imagen];
                if (img) {
                    ctx.drawImage(img, e.x - e.ancho / 2, e.y - e.alto / 2, e.ancho, e.alto);
                }

                ctx.fillStyle = 'red';
                ctx.fillRect(e.x - 20, e.y - 30, 40, 5);
                ctx.fillStyle = 'orange';
                ctx.fillRect(e.x - 20, e.y - 30, 40 * (e.vida / e.maxVida), 5);
            });

            gameState.proyectiles.forEach(p => {
                const img = imagenes[p.imagen];
                if (img) {
                    ctx.drawImage(img, p.x - 10, p.y - 10, 20, 20); 
                }
            });
            
            gameState.particulas.forEach(p => {
                ctx.fillStyle = p.color;
                ctx.globalAlpha = p.alpha;
                ctx.font = 'bold 18px sans-serif';
                ctx.fillText(p.text, p.x, p.y);
                ctx.globalAlpha = 1.0;
            });
        }
        
        // --- L√ìGICA DEL MODAL EDUCATIVO ---
        function openRecurso(recurso) {
            if (!recurso) return;
            gameState.paused = true;
            pauseStatusEl.textContent = '‚è∏Ô∏è';

            let videoId;
            const youtubeRegex = /(?:youtu\.be\/|youtube\.com\/(?:watch\?v=|embed\/|v\/|shorts\/))([^?&\n]+)/;
            const match = recurso.url.match(youtubeRegex);
            if (match && match[1]) {
                videoId = match[1];
            }

            const embedUrl = videoId ? `https://www.youtube.com/embed/${videoId}` : recurso.url;

            modalTitleEl.textContent = recurso.titulo;
            resourceIframeEl.src = embedUrl;
            fallbackBtn.onclick = () => window.open(recurso.url, '_blank');

            const iframeLoadTimeout = setTimeout(() => {
                resourceIframeEl.style.display = 'none';
                iframeFallbackEl.style.display = 'block';
            }, 2000);

            resourceIframeEl.onload = () => {
                clearTimeout(iframeLoadTimeout);
                resourceIframeEl.style.display = 'block';
                iframeFallbackEl.style.display = 'none';
            };

            modalEl.style.display = 'flex';
            gameState.modalStartTime = Date.now();
        }

        function closeRecurso() {
            modalEl.style.display = 'none';
            resourceIframeEl.src = 'about:blank';
            
            const tiempoTranscurrido = (Date.now() - gameState.modalStartTime) / 1000;
            if (tiempoTranscurrido >= OPCIONES.tiempoMinActividad) {
                gameState.puntos += OPCIONES.puntosBonus;
                playSound('recolectar');
                createParticle(canvas.width / 2, canvas.height / 2, `+${OPCIONES.puntosBonus}üåç Bonus!`, '#4caf50');
            } else {
                gameState.puntos += OPCIONES.puntosPenalizacion;
                playSound('error');
                createParticle(canvas.width / 2, canvas.height / 2, `${OPCIONES.puntosPenalizacion}üåç`, '#f44336');
            }
            
            gameState.paused = false;
            pauseStatusEl.textContent = '‚ñ∂Ô∏è';
            updateHUD();
            startOleada();
        }

        function updateHUD() {
            energiaVerdeEl.textContent = gameState.energia;
            puntosAmbientalesEl.textContent = gameState.puntos;
            oleadaActualEl.textContent = `${gameState.oleadaActual + 1} / ${OLEADAS.length}`;
        }
        
        function updateWaveProgress() {
            if (gameState.totalEnemigosOleada > 0) {
                const progress = (gameState.enemigosDerrotadosOleada / gameState.totalEnemigosOleada) * 100;
                waveProgressBar.style.width = `${progress}%`;
            } else {
                waveProgressBar.style.width = '0%';
            }
        }

        function endGame(isVictory) {
            if (gameState.gameOver) return;
            gameState.gameOver = true;
            gameOverTextEl.textContent = isVictory ? "¬°VICTORIA!" : "FIN DEL JUEGO";
            gameOverMessageEl.style.display = 'flex';
        }

        function restartGame() {
            gameOverMessageEl.style.display = 'none';
            initGame();
        }

        function createParticle(x, y, text, color) {
            gameState.particulas.push({ x, y, text, color, alpha: 1.0 });
        }

        function togglePause() {
            if (modalEl.style.display === 'flex' || startModalEl.style.display === 'flex' || gameState.gameOver) return;
            gameState.paused = !gameState.paused;
            pauseMessageEl.style.display = gameState.paused ? 'block' : 'none';
            pauseStatusEl.textContent = gameState.paused ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è';
        }

        function toggleMute() {
            gameState.muted = !gameState.muted;
            audioStatusEl.textContent = gameState.muted ? 'üîá' : 'üîä';
        }

        canvas.addEventListener('click', (e) => {
            if (gameState.paused || !gameState.selectedDefender) return;

            // üéØ INICIO DE LA CORRECCI√ìN DE COORDENADAS RESPONSIVE
            const gameWrapper = document.querySelector('.game-wrapper');
            const rect = gameWrapper.getBoundingClientRect();
            
            // 1. Calcular el factor de escala
            // Se usa el ancho visible actual del wrapper (rect.width) dividido por el ancho base (1010px)
            const scaleFactor = rect.width / 1010; 

            // 2. Obtener la posici√≥n del clic relativa al wrapper (el √°rea escalada)
            const clickX = e.clientX - rect.left;
            const clickY = e.clientY - rect.top;

            // 3. Aplicar el factor de escala inverso (coordenada no escalada)
            const originalX = clickX / scaleFactor;
            const originalY = clickY / scaleFactor;
            
            // 4. Transformar coordenadas: restar el ancho del MEN√ö (210px) y la altura del HUD (50px)
            const canvasX = originalX - 210; 
            const canvasY = originalY - 50; 

            // 5. Aplicar a la l√≥gica del juego (coordenadas relativas al canvas 800x600)
            if (canvasX >= 0 && canvasX <= 800 && canvasY >= 0 && canvasY <= 600) {
                const gridX = Math.floor(canvasX / 100);
                const gridY = Math.floor(canvasY / 100);
                
                if (gridX < 8 && gridY < 5) {
                    placeDefender(gridX, gridY);
                }
            }
            // üéØ FIN DE LA CORRECCI√ìN DE COORDENADAS RESPONSIVE
        });
        
        modalCloseBtn.addEventListener('click', closeRecurso);
        restartBtn.addEventListener('click', restartGame);

        startGameBtn.addEventListener('click', () => {
            startModalEl.style.display = 'none';
            loadImages().then(() => initGame());
        });
        
        window.addEventListener('keydown', (e) => {
            if (e.key.toLowerCase() === 'p') {
                togglePause();
            }
            if (e.key.toLowerCase() === 'm') {
                toggleMute();
            }
        });

        window.onload = () => {
            initAudio();
            startModalEl.style.display = 'flex';
        };

        /*
        ===================================================================================
        === C√ìMO PERSONALIZAR Y EXPANDIR EL JUEGO ===
        ===================================================================================
        
        1. A√ëADIR NUEVOS DEFENSORES:
           - Ve al bloque "PERSONALIZA AQU√ç".
           - En el array `DEFENSORES`, a√±ade un nuevo objeto con las propiedades:
             `id`, `nombre`, `imagen` (de RECURSOS_GRAFICOS), `costo`, `vida`, `ancho`, `alto`, `oleada`.
           - Si ataca, a√±ade `ataque`, `cadencia` (en ms) y `rango`.
           - Si genera energ√≠a, a√±ade `energiaExtra` y `cadencia`.
           - El juego lo a√±adir√° autom√°ticamente al men√∫.

        2. A√ëADIR NUEVOS ENEMIGOS:
           - En el array `ENEMIGOS`, a√±ade un nuevo objeto con:
             `id`, `imagen`, `vida`, `velocidad` (m√°s bajo es m√°s lento), `puntos`, `ancho`, `alto`.
           - Si es un jefe, a√±ade `esJefe: true` para que sea m√°s grande.

        3. MODIFICAR OLEADAS:
           - En el array `OLEADAS`, cada objeto es una oleada.
           - El array `enemigos` dentro de cada objeto define qu√© enemigos y en qu√©
             orden aparecer√°n. Simplemente a√±ade los `id` de los enemigos que quieras.

        4. CAMBIAR RECURSOS EDUCATIVOS:
           - En `RECURSOS_EDUCATIVOS`, modifica los objetos existentes o a√±ade nuevos.
           - `titulo`: El texto que aparecer√° en el modal.
           - `url`: ¬°IMPORTANTE! Usa URLs con "embed" para videos de YouTube. Para
             otras webs, aseg√∫rate de que permitan ser mostradas en un <iframe>.
             Si no, el juego mostrar√° la opci√≥n "Abrir en nueva pesta√±a".
        
        5. AJUSTAR LA DIFICULTAD:
           - En el objeto `OPCIONES`, puedes cambiar:
             - `energiaInicial`: Cu√°nta energ√≠a tienes al empezar.
             - `energiaAutomatica` e `intervaloEnergia`: La velocidad a la que ganas
               energ√≠a pasivamente.
             - `puntosBonus` y `puntosPenalizacion`: Recompensas por ver los recursos.
             - `tiempoMinActividad`: Segundos m√≠nimos para obtener el bonus.
        
        ===================================================================================
        */
    </script>
</body>
</html>
